<%= form_with(model: group, local: true) do |f| %>
  <% if group.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3">
      <h2><%= pluralize(group.errors.count, "error") %> prohibited this group from being saved:</h2>

      <ul>
        <% group.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="my-5 border-b">
    <%= f.text_field :name, class: "block shadow border-b border-gray-200 outline-none px-3 py-2 mt-2 w-full", placeholder: 'Your name' %>
  </div>

  <div class="field flex justify-center w-full border-orange-300 mt-8 items-center px-[2rem]">
    <%= f.file_field :icon, class: "hidden", id: "file-upload", accept: "image/*", onchange: "showPreview(this)" %>
    <%= label_tag :picture, class: 'upload-icon flex justify-start items-center gap-4 w-full max-w-[310px]', for: 'file-upload' do %>
      <div id="icon-container" class='flex justify-center items-center bg-gray-400 text-text-primary rounded-full h-[70px] w-[70px]'>
        <%= image_tag(url_for(group.icon), alt: "Group Icon", class: "fas fa-user fa-2x") if group.icon.attached? %>
      </div> 
      <p>Upload Picture</p>
    <% end %>
  </div>

  <div id="preview-container" class="hidden">
    <img id="preview-image" src="#" alt="Preview" class="rounded-full h-[70px] w-[70px]">
  </div>

  <div class="inline">
    <%= f.submit class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer" %>
  </div>
<% end %>


<script>
  function showPreview(input) {
  if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function(e) {
      document.getElementById('preview-image').src = e.target.result;
      document.getElementById('preview-container').style.display = 'block';
    }

    reader.readAsDataURL(input.files[0]);
  }
}
</script>